:root{
  --maxw: 1000px;          /* hard page max-width */
  --gap: 16px;
  --bg: #0f172a;           /* dark backdrop */
  --card: #fff;
  --ink: #0b1220;
  --muted: #64748b;
}

*{ box-sizing:border-box; }
html,body{ margin:0; }
body{
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--ink);
}

/* Page grid (3 columns) */
.page{
  max-width:var(--maxw);
  margin:24px auto 64px;
  padding:0 var(--gap);
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  grid-auto-rows: auto;
  gap:var(--gap);
  grid-template-areas:
    "title  title title"
    "lolli  lolli desc1"
    "map1   map1  map2"
    "desc2  desc3  desc4"
    "vTitle vTitle vTitle"
    "facet  facet  desc5"
    "heat   heat   desc6"
    "dTitle dTitle dTitle"
    "vAge   vGen   vEth"
    "desc7  desc8  desc9"
    "cTitle cTitle cTitle"
    "cAge   cGen   cEth"
    "desc10 desc11 desc12";
}

/* Cards */
.card{
  background:var(--card);
  border-radius:14px;
  padding:14px 16px 12px;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}
.card--title{ text-align:center; padding:22px 18px; }

.card__title{ margin:0 0 8px; font-size:18px; }
.subtitle{ margin:6px 0 0; color:var(--muted); }

/* Area hooks (attribute selectors keep markup simple) */
[style*="grid-area:title"]{ grid-area:title; }
[style*="grid-area:lolli"]{ grid-area:lolli; }
[style*="grid-area:desc1"]{ grid-area:desc1; }
[style*="grid-area:map1"]{ grid-area:map1; }
[style*="grid-area:map2"]{ grid-area:map2; }
[style*="grid-area:desc2"]{ grid-area:desc2; }
[style*="grid-area:desc3"]{ grid-area:desc3; }
[style*="grid-area:desc4"]{ grid-area:desc4; }
[style*="grid-area:vTitle"]{ grid-area:vTitle; }
[style*="grid-area:facet"]{ grid-area:facet; }
[style*="grid-area:desc5"]{ grid-area:desc5; }
[style*="grid-area:heat"]{ grid-area:heat; }
[style*="grid-area:desc6"]{ grid-area:desc6; }
[style*="grid-area:dTitle"]{ grid-area:dTitle; }
[style*="grid-area:vAge"]{ grid-area:vAge; }
[style*="grid-area:vGen"]{ grid-area:vGen; }
[style*="grid-area:vEth"]{ grid-area:vEth; }
[style*="grid-area:desc7"]{ grid-area:desc7; }
[style*="grid-area:desc8"]{ grid-area:desc8; }
[style*="grid-area:desc9"]{ grid-area:desc9; }
[style*="grid-area:cTitle"]{ grid-area:cTitle; }
[style*="grid-area:cAge"]{ grid-area:cAge; }
[style*="grid-area:cGen"]{ grid-area:cGen; }
[style*="grid-area:cEth"]{ grid-area:cEth; }
[style*="grid-area:desc10"]{ grid-area:desc10; }
[style*="grid-area:desc11"]{ grid-area:desc11; }
[style*="grid-area:desc12"]{ grid-area:desc12; }

/* Viz containers (let Vega fill them) */
.viz{ width:100%; min-height:280px; }
.viz--map   { width: 100%; height: 500px; }   /* whole nation */
.viz--mapSm { min-height:420px; }   /* state zoom  */
.viz--tall  { min-height:500px; }

/* Ensure embeds fill card width */
.vega-embed, .vega-embed > * { width:100% !important; }

/* Responsive: stack on narrower screens */
@media (max-width: 800px){
  .page{
    grid-template-columns: 1fr;
    grid-template-areas:
      "title"
      "lolli"
      "desc1"
      "map1"
      "map2"
      "desc2"
      "desc3"
      "desc4"
      "facet"
      "desc5"
      "heat"
      "desc6"
      "vAge"
      "vGen"
      "vEth"
      "desc7"
      "desc8"
      "desc9"
      "cAge"
      "cGen"
      "cEth"
      "desc10"
      "desc11"
      "desc12";
  }
  .viz--map{   min-height:440px; }
  .viz--mapSm{ min-height:360px; }
}