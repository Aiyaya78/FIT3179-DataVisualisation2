{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text": "GE15 Parliamentary Seats by Party", "anchor": "start"},
  "width": "container",
  "height": "container",
  "autosize": {"type": "fit", "contains": "padding"},

  "data": {
    "url": "https://raw.githubusercontent.com/Aiyaya78/FIT3179-DataVisualisation2/main/data/ge15_coalition_summary.csv",
    "format": {"type": "csv"}
  },

  "transform": [
    {
      "lookup": "coalition",
      "from": {
        "data": {
          "values": [
            {"coalition": "PH", "full": "Pakatan Harapan (PH)"},
            {"coalition": "PN", "full": "Perikatan Nasional (PN)"},
            {"coalition": "BN", "full": "Barisan Nasional (BN)"},
            {"coalition": "GPS", "full": "Gabungan Parti Sarawak (GPS)"},
            {"coalition": "GRS", "full": "Gabungan Rakyat Sabah (GRS)"},
            {"coalition": "WARISAN", "full": "Parti Warisan Sabah (WARISAN)"},
            {"coalition": "IND/OTH", "full": "Independent / Others"}
          ]
        },
        "key": "coalition",
        "fields": ["full"]
      }
    },
    {"joinaggregate": [{"op": "sum", "field": "seats", "as": "totalSeats"}]},
    {"calculate": "datum.seats / datum.totalSeats * 100", "as": "pct"},
    {"calculate": "format(datum.pct, '.1f') + '%'", "as": "pctLabel"}
  ],

  "layer": [
    {
      "description": "Lollipop stick (thin bar)",
      "mark": {"type": "bar", "height": 3, "cornerRadiusEnd": 2},
      "encoding": {
        "x": {
          "field": "seats",
          "type": "quantitative",
          "title": "Seats",
          "axis": {"grid": true},
          "scale": {"domainMin": 0}
        },
        "y": {
          "field": "coalition",
          "type": "nominal",
          "sort": ["PH", "PN", "BN", "GPS", "GRS", "IND/OTH", "WARISAN"],
          "title": "Coalition"
        },
        "color": {
          "field": "coalition",
          "type": "nominal",
          "legend": null,
          "scale": {
            "domain": ["PH","PN","BN","GPS","GRS","WARISAN","IND/OTH"],
            "range": ["#ea152c","#0089fd","#ff89c2","#036b7e","#af30c1","#ffcb09","#d2d1d6"]
          }
        }
      }
    },

    {
      "description": "Lollipop head (circle at end)",
      "mark": {"type": "point","filled":true, "size": 200, "opacity":1},
      "encoding": {
        "x": {"field": "seats", "type": "quantitative"},
        "y": {
          "field": "coalition",
          "type": "nominal",
          "sort": ["PH", "PN", "BN", "GPS", "GRS", "IND/OTH", "WARISAN"]
        },
        "color": {
          "field": "coalition",
          "type": "nominal",
          "legend": null,
          "scale": {
            "domain": ["PH","PN","BN","GPS","GRS","WARISAN","IND/OTH"],
            "range": ["#ea152c","#0089fd","#ff89c2","#036b7e","#af30c1","#ffcb09","#d2d1d6"]
          }
        },
        "tooltip": [
          {"field": "full", "title": "Party"},
          {"field": "seats", "title": "Seats"},
          {"field": "totalSeats", "title": "Total Seats"},
          {"field": "pctLabel", "title": "Seat Share"}
        ]
      }
    }
  ],

  "config": {
    "view": {"stroke": null},
    "axis": {"grid": false}
  }
}