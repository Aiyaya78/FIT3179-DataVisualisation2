{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "GE15 Constituency-Level Results by Winning Party",
  "width": 1000,
  "height": 600,

  "params": [
    {
      "name": "zoom_level",
      "value": 2500,
      "bind": {"input": "range", "min": 2800, "max": 70000, "step": 500, "name": "Zoom: "}
    },
    {
      "name": "center_to",
      "value": [109.5, 4.2],
      "bind": {
        "input": "select",
        "options": [
          [109.5, 4.2],
          [100.2, 6.5],   
          [100.5, 5.8],   
          [100.4, 5.3],   
          [100.9, 4.7],   
          [101.9, 2.8],   
          [102.3, 2.2],   
          [102.3, 2.4],   
          [103.5, 2.0],   
          [102.9, 3.3],   
          [104.0, 4.5],   
          [103.3, 5.4],   
          [110.3, 1.6],   
          [116.1, 6.0],   
          [115.0, 5.3],   
          [101.7, 3.1]    
        ],
        "labels": [
          "Malaysia (All)",
          "Perlis",
          "Kedah",
          "Penang",
          "Perak",
          "Selangor",
          "Negeri Sembilan",
          "Melaka",
          "Johor",
          "Pahang",
          "Terengganu",
          "Kelantan",
          "Sarawak",
          "Sabah",
          "Labuan",
          "Kuala Lumpur / Putrajaya"
        ],
        "name": "Zoom to State: "
      }
    }
  ],

  "projection": {
    "type": "mercator",
    "center": {"expr": "center_to"},
    "scale": {"expr": "zoom_level"}
  },

  "layer": [

    {
      "data": {
        "url": "https://raw.githubusercontent.com/Aiyaya78/FIT3179-DataVisualisation2/main/js/malaysia.parlimen.geojson",
        "format": {"type": "json", "property": "features"}
      },
      "transform": [
        {
          "lookup": "properties.parlimen",
          "from": {
            "data": {
              "url": "https://raw.githubusercontent.com/Aiyaya78/FIT3179-DataVisualisation2/main/data/ge15_winningANDturnout_by_constituency.csv"
            },
            "key": "id_geo",
            "fields": ["state","code_parlimen","constituency","winning_party","winning_majority","turnout_percent"]
          }
        },
        {
          "lookup": "winning_party",
          "from": {
            "data": {
              "values": [
                {"coalition": "PH", "full": "Pakatan Harapan (PH)"},
                {"coalition": "PN", "full": "Perikatan Nasional (PN)"},
                {"coalition": "BN", "full": "Barisan Nasional (BN)"},
                {"coalition": "GPS", "full": "Gabungan Parti Sarawak (GPS)"},
                {"coalition": "GRS", "full": "Gabungan Rakyat Sabah (GRS)"},
                {"coalition": "WARISAN", "full": "Parti Warisan Sabah (WARISAN)"},
                {"coalition": "IND/OTH", "full": "Independent / Others"}
              ]
            },
            "key": "coalition",
            "fields": ["full"]
          },
          "as": ["winning_party_full"]
        }
      ],
      "mark": {"type": "geoshape", "stroke": "white", "strokeWidth": 0.5},
      "encoding": {
        "color": {
          "field": "winning_party",
          "type": "nominal",
          "scale": {
            "domain": ["PH","PN","BN","GPS","GRS","WARISAN","IND/OTH"],
            "range": ["#ab3377", "#4377a9", "#ffb110", "#248832", "#65cded", "#ee6678", "#bbbbbb"]
          },
          "title": "Winning Party"
        },
        "tooltip": [
          {"field": "code_parlimen", "title": "Parliament Code"},
          {"field": "constituency", "title": "Constituency"},
          {"field": "state", "title": "State"},
          {"field": "winning_party_full", "title": "Winner"},
          {"field": "winning_majority", "type": "quantitative", "title": "Winning Majority", "format": ","},
          {"field": "turnout_percent", "type": "quantitative", "title": "Turnout (%)", "format": ".2f"}
        ]
      }
    },
    {
        "data": {
            "url": "https://raw.githubusercontent.com/Aiyaya78/FIT3179-DataVisualisation2/refs/heads/main/js/states.geojson",
            "format": {"type": "json", "property": "features"}
        },
        "mark": {"type": "geoshape", "fill": null, "stroke": "#000000", "strokeWidth": 1.5}
        }
  ],

  "config": {
    "view": {"stroke": null}
  }
}
